$((function(){"use strict";var t=false;$(".js-add-to-user-list").on("click",(function(i){$("#modal_add_to_list").modal("show");if(!t){AjaxApiRequest.makeGetApiRequest("/api/list/paginated-lists/",(function(t){if(t.success){$("#modal_add_to_list .loading").remove();$("#modal_add_to_list .js-simple-paginator-container").html(t.html)}else{Phoenix.Ui.showErrorMessage("Could not load lists");$("#modal_add_to_list").modal("hide")}}),(function(){Phoenix.Ui.showErrorMessage("Could not load lists");$("#modal_add_to_list").modal("hide")}));t=true}i.preventDefault()}));$("#modal_add_to_list").on("click","tr.js-add-list",(function(t){var i=$("#modal_add_to_list table").data("object-guid");var o=$(t.target);if(!o.is("tr")){o=o.parents("tr")}var a=o.attr("data-ref-id");AjaxApiRequest.makeGetApiRequest("/api/list/"+a+"/add-item/"+i+"/",(function(t){if(t.success){Phoenix.Ui.showSuccessMessage("Successfully added item to list.");$("#modal_add_to_list").modal("hide")}else{Phoenix.Ui.showErrorMessage("Error while adding object to list.");$("#modal_add_to_list").modal("hide")}}),(function(){Phoenix.Ui.showErrorMessage("Error while adding object to list.");$("#modal_add_to_list").modal("hide")}))}))}));
$((function(){"use strict";var t;var e="js-upvote-btn";var a="js-post-render-upvote";var r="upvote-in-progress";var n="disabled";var i="upvoted";var s="."+e;var o=".js-event-tracking";var u=".js-upvote-btn__text";var f=".js-upvote-status";var d;var v={};var c=function(e){return t.filter('[data-guid="'+e+'"]')};var l=function(){var t=$("<span/>");var a=[e,r,"js-event-tracking"].join(" ");return function(e){var r,o,f;if(!e||e.length<1){return}var d=!e.data("userVoted");e.data("userVoted",d);r=e.find(s);if(d){r.addClass(i);e.attr("action","/vote/?unvote=1")}else{r.removeClass(i);e.attr("action","/vote/")}f=r.find(u);var v=f.text();f.text(f.data("successMsg"));f.data("successMsg",v);if(e.data("allowUnvote")){return}o=t.clone();o.addClass(r.attr("class")).removeClass(a).append(r.contents());e.replaceWith(o);o.addClass(n);e.off(".upvote")}}();var g=function(t){t.each((function(){l($(this))}))};var h=function(t){var e=t.find(s);t.addClass(r);e.each((function(){var t=$(this),e=t.find(u),a=e.data("progressMsg");if(a){if(!e.data("originalMsg")){e.data("originalMsg",e.text())}e.text(a)}}))};var p=function(t){var e=t.find(s);t.removeClass(r);e.each((function(){var t=$(this),e=t.find(u),a=e.data("originalMsg");if(a){e.text(a)}}))};var m=function(t,e){var a;if(!t||t.length<1){return}a=t.next(f);if(!a||a.length<1){return}a.html(e.buttonCount)};var b=function(t,e){var a="Upvoting isn't working right now, please try again later.";if(e&&e.errorMsg){a=e.errorMsg}if(Phoenix&&Phoenix.Ui&&Phoenix.Ui.showErrorMessage){Phoenix.Ui.showErrorMessage(a,{hideDelay:3e3})}p(t)};var k=function(){var t;return function(e,a){if(!t){t={}}var n=t[e],i,u,f;if(!!n){return}i=a.find(s);u=a.find(o);u.trigger("customEventTracking");f=c(e);n=$.ajax({url:a.attr("action"),type:"POST",data:a.serializeArray(),error:function(){b(f)},success:function(t){if(!!t.voteFailed){b(f,t);return}if(!!t.buttonCount){m(f,t)}g(f);if(t.csrfToken){var e=a.find("input[data-bb]").val(t.csrfToken);if(t.csrfToken.length>43){e.removeAttr("data-decrypted")}if(t.csrfTokenId){a.find("input[name*='_token_id']").val(t.csrfTokenId);var r=e.attr("data-token-id");e.attr("data-token-id",r.substring(0,r.length-t.csrfTokenId.length)+t.csrfTokenId)}}},complete:function(){f.removeClass(r);delete v[e];delete t[e]}});t[e]=n}}();var x=function(t){t.preventDefault();var e=$(this),a,r=e.data("guid"),n=!!v[r];if(n){return}v[r]=e;a=c(r);h(a);if(d){return}k(r,e)};var M=function(){var e=function(t,e){var a=t.next(f).find(".js-upvote-status-msg"),r=e.statusMsg;if(r){a.replaceWith(r)}if(e.hasVoted){return}};var r=function(t,a){var r=c(t),n;if(!r||r.length<1){return}r.each((function(){e($(this),a)}));n=v[t];if(a.hasVoted){j(r)}else if(n&&n.length>0){delete v[t];n.trigger("submit")}};return function(){PostRender.getPostRenderData("UserBundle",(function(e,n){d=false;t.removeClass(a).removeAttr("data-post-render-param");if($.isEmptyObject(n)){return}var i=n.upvote;if($.isEmptyObject(i)){return}$.each(i,r)}))}}();var j=function(t){var e=t.find(u);if(e.data("hasVotedMsg")){e.data("successMsg",e.data("hasVotedMsg"))}g(t)};var C=function(){t=$(".js-upvote-form");if(!t||t.length<1){return}d=t.hasClass(a);var e=t.filter((function(){return!$(this).data("submit.upvote.bound")})).on("submit.upvote",x).data("submit.upvote.bound",true);e.each((function(){var t=$(this);if(t.data("userVoted")){t.data("userVoted",false);j(t)}}))};C();if(true===d){M()}$(document).ajaxSuccess(C)}));
(function(t){"use strict";var r=$("#js-scroll-indicator"),n=$(".js-scroll-indicator-target"),i;if(!r||r.length<1){return}n=r.closest(".js-scroll-indicator-target");if(!n||n.length<1){return}i=$(window);var o=function(){var t=scrollMonitor.create(n),i;if(t.isInViewport){return}i=r.data("hidden-class");r.removeClass(i);t.one("enterViewport",(function(){r.addClass(i)}))};i.on("load",(function(){o()}))})(this);
$(function(t){"use strict";var a=0;var e=$('a[href*="https://assoc-redirect.amazon.com/g/r/"]');e.each((function(){var t=$(this).attr("href");t=t.replace("vg%3A-","vg%3A"+$("#view-guid-meta").attr("content"));var a=$(this).parent().closest("article").attr("data-guid");if(a===undefined){a=$(this).parent().closest("article").find("form").attr("data-guid")}t=t.replace("ag%3A-","ag%3Ags-"+a);$(this).prop("href",t)}));$(document).on("on_page_event ajaxContentLoaded",(function(){a=a+1;var t=$(".js-seamless-content__page-content").eq(a),e=t.find('a[href*="https://assoc-redirect.amazon.com/g/r/"]');e.each((function(){var t=$(this).attr("href");t=t.replace("vg%3A-","vg%3A"+$("#view-guid-meta").attr("content"));t=t.replace("ag%3A-","ag%3Ags-"+$(this).parent().closest("article").attr("data-guid"));$(this).prop("href",t)}))}))}(this));